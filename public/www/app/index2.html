<!doctype html>
<html>
  <head>
  <title>Java Friends</title>
</head>
<body>
  <table id="qqq" style="font-weight: bold">
    <tr style="background-color:red"><td>a</td><td>b</td></tr>
    <tr><td>1</td><td>2</td></tr>
    <tr>
      <td colspan="2">
         中文
      </td>
    </tr>
  </table>

<input type="button" onclick="tableToExcel('qqq', 'myexcel')" value="Export to Excel">
<script src="../bower_components/excellentexport/excellentexport.js"></script>
<script>
  var tableToExcel = (function() {
    var uri = 'data:application/vnd.ms-excel;base64,'
    , template = '<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head><!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--></head><body><table>{table}</table></body></html>'
    , base64 = function(s) { return window.btoa(unescape(encodeURIComponent(s))) }
    , format = function(s, c) { return s.replace(/{(\w+)}/g, function(m, p) { return c[p]; }) }
    return function(table, name) {
    if (!table.nodeType) table = document.getElementById(table)
      var ctx = {worksheet: name || 'Worksheet', table: table.innerHTML}
      window.location.href = uri + base64(format(template, ctx))
      console.log(window.location.href);
    }
  })() 
</script>

<hr>

<table id="datatable">
  <tbody>
    <tr>
      <th>qqq</th>
      <th>www</th>
      <th>eee</th>
    </tr>  
    <tr>
      <td>100</td> 
      <td>200</td> 
      <td>300</td>
    </tr>
    <tr>
      <td colspan='3'>中文</td>
    </tr>
    <tr>
      <td colspan='3'>
        <ul>
          <li>这是第一个</li>
          <li>这是第二个</li>  
          <li>这是第三个</li>
          <li>这是第四个</li>
          <li>这是第五个</li>
        </ul>
      </td>
    </tr>
    <tr>
      <td colspan='3'>can't</td>
    </tr>
  </tbody>
</table>

<a download="somedata.xls" href="#" onclick="return ExcellentExport.excel(this, 'datatable', 'Sheet Name Here');">Export to Excel</a>
</body>
</html>